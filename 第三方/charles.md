
Charles是一个HTTP代理/HTTP监视器/反向代理，使开发人员能够查看其机器和Internet之间的所有HTTP和SSL/HTTPS流量。这包括请求(request)，响应(response)和HTTP标头（包含cookie和缓存信息）。

Charles通过将自己设置成系统的网络访问代理服务器，使得所有的网络访问请求都通过它来完成，从而实现了网络封包的截取和分析。

除了在做移动开发中调试端口外，Charles 也可以用于分析第三方应用的通讯协议。配合 Charles 的 SSL 功能，Charles 还可以分析 Https 协议。



## 第一次启动 Charles

启动 Charles 后，第一次 Charles 会询问你是否把 Charles 设置为系统的代理，如果此时你忽略了这个询问敞口，你可以在后期设置的；将 Charles 设置成系统代理：选择菜单中的 “Proxy” -> “Mac OS X Proxy/windows proxy” 来将 Charles 设置成系统代理，参考如下，如果 Mac 下有管理密码，需要输入密码后方可进行；

![](https://a.axihe.com/img/charles/image_thumb.png)


## Charles 抓包配置

设置的主界面如下：

![](https://a.axihe.com/img/charles/charles_proxy_04.png)

### 动态端口

启用动态端口选项来监听动态端口，每次查询启动时选择。这样可以避免与计算机上可能运行的其他网络服务的冲突，包括Charles的其他实例（如果是共享计算机）如果你开的端口很多，搞到你自己都记不清楚了，那么推荐你用这个；但是我都是写好一个端口的，比如代理写 8888，别的就不会监听这个端口了，而且为了手机方便连接，都是使用指定好的端口。

_注意：如果你charles设置了8888的端口，别的服务就不能再使用这个端口号了，否则冲突会发生意外的错误；_

### 透明的HTTP代理

透明代理使Charles能够支持不支持HTTP代理服务器的客户端，或者不知道他们正在使用HTTP代理服务器，例如TCP / IP连接由路由器或防火墙重定向到Charles。这里可以被手机连接；

手机连接的时候，http代理那里写=选手动，并填写此时charles的本机地址和上面设置的8888端口即可；

### options里，主要是设置绕过代理

这里可以设置您的浏览器/操作系统遇到哪些域名的时候，使用默认而不用Charles；配置的列表使用空格或逗号分隔，并在Charles配置其代理设置时注入浏览器。 有关详细信息，请参阅操作系统和浏览器特定选项卡。

后面系统代理和火狐浏览器的就不写了，主要是一些开关和配置，因为也不用火狐，都默认就可以了；



## 手机抓包HTTPS设置以及证书安装

第一步：设置charles为允许状态，并设置好接入端口；

第二部：把手机按照charles的IP和端口进行配置；

第三步，手机配对成功后，charles弹窗询问是否允许；


